import{r as c,c as g,o as t,a as d,h as b,w as k,u as e,a3 as y,X as V,d as r,a9 as w,g as f,aa as E,ab as O,ac as R,ad as B,ae as C,F,i as D,af as H}from"./.pnpm-DeAMUJ_Q.js";import{_ as I}from"./index-DlcL_LV4.js";const L={class:"online-preview"},N={class:"offece-box"},T={__name:"index",setup(U){const i=c(!1),l=c(""),o=c(""),p=c([{label:"pdf",value:"https://501351981.github.io/vue-office/examples/dist/static/test-files/test.pdf"},{label:"docx",value:"https://501351981.github.io/vue-office/examples/dist/static/test-files/test.docx"},{label:"excel",value:"http://static.shanhuxueyuan.com/demo/excel.xlsx"}]),s=g(()=>l.value.substring(l.value.lastIndexOf(".")+1)),h=()=>{i.value=!0,["pdf","docx","xlsx"].includes(s.value)&&R(()=>{o.value=l.value}),s.value=="xlsx"&&setTimeout(()=>{n()},1e3)};function n(){i.value=!1,console.log("渲染完成")}function u(){console.log("渲染失败")}return(P,x)=>{const v=H,_=B,m=C;return t(),d("div",L,[b(_,{modelValue:e(l),"onUpdate:modelValue":x[0]||(x[0]=a=>y(l)?l.value=a:null),placeholder:"选择文件",teleported:!1,onChange:h},{default:k(()=>[(t(!0),d(F,null,D(e(p),a=>(t(),r(v,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),V((t(),d("div",N,[e(s)==="pdf"?(t(),r(e(w),{key:0,src:e(o),style:{width:"100%",height:"100%"},onRendered:n,onError:u},null,8,["src"])):f("",!0),e(s)==="docx"?(t(),r(e(E),{key:1,src:e(o),ignoreWidth:!1,ignoreHeight:!0,style:{width:"100%",height:"100%"},onRendered:n,onError:u},null,8,["src"])):f("",!0),e(s)==="xlsx"?(t(),r(e(O),{key:2,src:e(o),style:{width:"100%",height:"500px"},onRendered:n,onError:u},null,8,["src"])):f("",!0)])),[[m,e(i)]])])}}},X=I(T,[["__scopeId","data-v-d7493a27"]]);export{X as default};
